{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "resourceGroupName": {
      "value": "RG-IL-Z"
    },
    "location": {
      "value": "eastus"
    },
    "suffix": {
      "value": "ilz"
    },
    "environment": {
      "value": "dev"
    },
    "vnetAddressSpaces": {
      "value": [
        "10.0.0.0/16"
      ]
    },
    "vnetSubnets": {
      "value": [
        {
          "name": "apim",
          "address_prefixes": [
            "10.0.1.0/24"
          ],
          "serviceEndpoints": [
            "Microsoft.KeyVault",
            "Microsoft.Storage"
          ],
          "nsg": {
            "name": "apim-nsg",
            "security_rules": [
              {
                "name": "Allow_APIM_Management_Inbound",
                "priority": 100,
                "direction": "Inbound",
                "access": "Allow",
                "protocol": "Tcp",
                "source_port_range": "*",
                "destination_port_range": "3443",
                "source_address_prefix": "ApiManagement",
                "destination_address_prefix": "VirtualNetwork",
                "description": "Allow APIM management traffic"
              }
            ]
          }
        },
        {
          "name": "ase",
          "address_prefixes": [
            "10.0.2.0/24"
          ],
          "delegation": {
            "name": "ase-delegation",
            "service_name": "Microsoft.Web/hostingEnvironments",
            "actions": [
              "Microsoft.Network/virtualNetworks/subnets/action"
            ]
          }
        },
        {
          "name": "private-endpoints",
          "address_prefixes": [
            "10.0.3.0/24"
          ]
        }
      ]
    },
    "tags": {
      "value": {
        "Environment": "Development",
        "Project": "Integration Landing Zone"
      }
    },
    "keyVaultPurgeProtectionEnabled": {
      "value": true
    },
    "keyVaultSoftDeleteRetentionDays": {
      "value": 7
    },
    "deployApiManagement": {
      "value": true
    },
    "apimPublisherName": {
      "value": "Example Corporation"
    },
    "apimPublisherEmail": {
      "value": "admin@example.com"
    },
    "apimSkuName": {
      "value": "Developer"
    },
    "apimSkuCapacity": {
      "value": 1
    },
    "deployAppServiceEnvironment": {
      "value": false
    },
    "storageAccounts": {
      "value": [
        {
          "name_prefix": "integration",
          "sku_name": "Standard_LRS",
          "account_kind": "StorageV2",
          "access_tier": "Hot",
          "private_endpoints": [
            "blob",
            "file"
          ],
          "create_private_dns_zone": true,
          "blob_containers": [
            {
              "name": "archive",
              "container_access_type": "private"
            },
            {
              "name": "incoming",
              "container_access_type": "private"
            }
          ]
        }
      ]
    },
    "deployServiceBus": {
      "value": true
    },
    "serviceBusCapacityUnits": {
      "value": 1
    },
    "serviceBusQueues": {
      "value": [
        {
          "name": "orders-queue",
          "maxSizeInMegabytes": 1024,
          "defaultMessageTtl": "P14D",
          "maxDeliveryCount": 10
        },
        {
          "name": "notifications-queue",
          "maxSizeInMegabytes": 1024,
          "defaultMessageTtl": "P7D",
          "maxDeliveryCount": 5,
          "requiresSession": true,
          "deadLetteringOnMessageExpiration": true
        }
      ]
    },
    "serviceBusTopics": {
      "value": [
        {
          "name": "events",
          "maxSizeInMegabytes": 1024,
          "defaultMessageTtl": "P14D",
          "subscriptions": [
            {
              "name": "all-events",
              "maxDeliveryCount": 10
            },
            {
              "name": "critical-events",
              "maxDeliveryCount": 20,
              "defaultMessageTtl": "P7D",
              "requiresSession": true
            }
          ]
        }
      ]
    }
  }
}